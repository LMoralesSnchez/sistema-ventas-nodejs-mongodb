<%- include("template/cabecera", {tituloweb: "Detalle del Proveedor"}) %> 

<div class="container">
    <h1>Detalle del Proveedor</h1>
    <% if (error) { %>
        <p>
            <%= mensaje %>
        </p>
      <a href="/proveedores" class="btn btn-dark btn-block">Volver al listado de proveedores</a>
    <% } %>
    <% if (!error) { %>
        <table class="table">
            <thead>
              <tr>
                <th scope="col">id</th>
                <th scope="col">idProveedor</th>
                <th scope="col">Nombre</th>
                <th scope="col">Telefono</th>
                <th scope="col">Direccion</th>
                <th scope="col">Ciudad</th>
                <th scope="col">Accion</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row"><%= proveedor.id %> </th>
                <td><%= proveedor.idProveedor %></td>
                <td><%= proveedor.nombre %></td>
                <td><%= proveedor.telefono %></td>
                <td><%= proveedor.direccion %></td>
                <td><%= proveedor.ciudad %></td> 
                <td>
                    <button class="btn btn-danger btn-sm" id= "btnEliminar" data-id="<%= proveedor.id %>">Eliminar</button>
                </td> 
              </tr>
            </tbody>
          </table>
    <% } %>
</div>
<%- include("template/footer" ) %> 
<script>

    const btnEliminar = document.querySelector('#btnEliminar')

    btnEliminar.addEventListener('click', async() =>{
        /* console.log('Me diste click') */
        const id = btnEliminar.dataset.id
        console.log('id: ', id)
        try {
            const data = await fetch(`/proveedores/${id}`,{
                method: 'delete'
            })
            const res = await data.json()
            if(res.estado){
                window.location.href = '/proveedores'
             }
        } catch (error) {
            console.log(error)
        }
    })

</script>
